{"ast":null,"code":"import{useState}from\"react\";import{motion}from\"framer-motion\";import{getGift,markGiftUsed}from\"../api\";import\"./CheckGiftPage.css\";// üì• –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";async function downloadGift(url){const res=await fetch(url);const blob=await res.blob();const blobUrl=URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=blobUrl;a.download=\"gift.png\";document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(blobUrl);}export default function CheckGiftPage(){const[code,setCode]=useState(\"\");const[giftUrl,setGiftUrl]=useState(null);const[message,setMessage]=useState(\"\");const[opening,setOpening]=useState(false);const[checking,setChecking]=useState(false);async function handleCheck(){if(checking||!code.trim())return;setChecking(true);setMessage(\"\");setGiftUrl(null);setOpening(false);try{var _res$gift;const res=await getGift(code.trim().toUpperCase());if(res!==null&&res!==void 0&&(_res$gift=res.gift)!==null&&_res$gift!==void 0&&_res$gift.file_url&&!res.gift.is_used){setGiftUrl(res.gift.file_url);setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");}else{setMessage(\"‚ùå –ö–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω\");}}catch(_unused){setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");}finally{setChecking(false);}}async function handleGiftClick(){if(!giftUrl||opening)return;setOpening(true);setTimeout(async()=>{await downloadGift(giftUrl);await markGiftUsed(code.trim().toUpperCase());},1200);}return/*#__PURE__*/_jsxs(\"div\",{className:\"check-page\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"gift \".concat(giftUrl?\"active\":\"\"),onClick:handleGiftClick,animate:giftUrl?opening?{scale:[1,1.3,0.6],rotate:[0,10,-10,0],opacity:[1,1,0]}:{scale:[1,1.08,1]}:{},transition:opening?{duration:1.2,ease:\"easeInOut\"}:giftUrl?{duration:1.4,repeat:Infinity}:{},children:\"\\uD83C\\uDF81\"}),!giftUrl&&/*#__PURE__*/_jsxs(\"div\",{className:\"code-box\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0435\\u043A\\u0440\\u0435\\u0442\\u043D\\u044B\\u0439 \\u043A\\u043E\\u0434\",value:code,onChange:e=>setCode(e.target.value.toUpperCase())}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCheck,disabled:checking,children:checking?\"–ü—Ä–æ–≤–µ—Ä–∫–∞...\":\"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"hint\",children:message})]});}","map":{"version":3,"names":["useState","motion","getGift","markGiftUsed","jsx","_jsx","jsxs","_jsxs","downloadGift","url","res","fetch","blob","blobUrl","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","CheckGiftPage","code","setCode","giftUrl","setGiftUrl","message","setMessage","opening","setOpening","checking","setChecking","handleCheck","trim","_res$gift","toUpperCase","gift","file_url","is_used","_unused","handleGiftClick","setTimeout","className","children","div","concat","onClick","animate","scale","rotate","opacity","transition","duration","ease","repeat","Infinity","placeholder","value","onChange","e","target","disabled"],"sources":["C:/Users/–ö—Å–µ–Ω–∏—è/Desktop/gift-frontend/frontend/src/pages/CheckGiftPage.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { getGift, markGiftUsed } from \"../api\";\r\nimport \"./CheckGiftPage.css\";\r\n\r\n// üì• –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞\r\nasync function downloadGift(url) {\r\n  const res = await fetch(url);\r\n  const blob = await res.blob();\r\n\r\n  const blobUrl = URL.createObjectURL(blob);\r\n  const a = document.createElement(\"a\");\r\n  a.href = blobUrl;\r\n  a.download = \"gift.png\";\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  document.body.removeChild(a);\r\n  URL.revokeObjectURL(blobUrl);\r\n}\r\n\r\nexport default function CheckGiftPage() {\r\n  const [code, setCode] = useState(\"\");\r\n  const [giftUrl, setGiftUrl] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [opening, setOpening] = useState(false);\r\n  const [checking, setChecking] = useState(false);\r\n\r\n  async function handleCheck() {\r\n    if (checking || !code.trim()) return;\r\n\r\n    setChecking(true);\r\n    setMessage(\"\");\r\n    setGiftUrl(null);\r\n    setOpening(false);\r\n\r\n    try {\r\n      const res = await getGift(code.trim().toUpperCase());\r\n\r\n      if (res?.gift?.file_url && !res.gift.is_used) {\r\n        setGiftUrl(res.gift.file_url);\r\n        setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");\r\n      } else {\r\n        setMessage(\"‚ùå –ö–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω\");\r\n      }\r\n    } catch {\r\n      setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");\r\n    } finally {\r\n      setChecking(false);\r\n    }\r\n  }\r\n\r\n  async function handleGiftClick() {\r\n    if (!giftUrl || opening) return;\r\n\r\n    setOpening(true);\r\n\r\n    setTimeout(async () => {\r\n      await downloadGift(giftUrl);\r\n      await markGiftUsed(code.trim().toUpperCase());\r\n    }, 1200);\r\n  }\r\n\r\n  return (\r\n    <div className=\"check-page\">\r\n      <motion.div\r\n        className={`gift ${giftUrl ? \"active\" : \"\"}`}\r\n        onClick={handleGiftClick}\r\n        animate={\r\n          giftUrl\r\n            ? opening\r\n              ? {\r\n                  scale: [1, 1.3, 0.6],\r\n                  rotate: [0, 10, -10, 0],\r\n                  opacity: [1, 1, 0],\r\n                }\r\n              : { scale: [1, 1.08, 1] }\r\n            : {}\r\n        }\r\n        transition={\r\n          opening\r\n            ? { duration: 1.2, ease: \"easeInOut\" }\r\n            : giftUrl\r\n            ? { duration: 1.4, repeat: Infinity }\r\n            : {}\r\n        }\r\n      >\r\n        üéÅ\r\n      </motion.div>\r\n\r\n      {!giftUrl && (\r\n        <div className=\"code-box\">\r\n          <input\r\n            placeholder=\"–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥\"\r\n            value={code}\r\n            onChange={(e) => setCode(e.target.value.toUpperCase())}\r\n          />\r\n          <button onClick={handleCheck} disabled={checking}>\r\n            {checking ? \"–ü—Ä–æ–≤–µ—Ä–∫–∞...\" : \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {message && <div className=\"hint\">{message}</div>}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}