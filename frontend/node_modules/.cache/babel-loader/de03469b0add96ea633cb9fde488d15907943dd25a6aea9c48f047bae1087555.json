{"ast":null,"code":"import{useState}from\"react\";import{motion}from\"framer-motion\";import{checkGift,markGiftUsed}from\"../api\";import\"./CheckGiftPage.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";async function downloadFile(url){const res=await fetch(url);const blob=await res.blob();const blobUrl=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=blobUrl;a.download=\"gift\";document.body.appendChild(a);a.click();document.body.removeChild(a);window.URL.revokeObjectURL(blobUrl);}function CheckGiftPage(){const[code,setCode]=useState(\"\");const[gift,setGift]=useState(null);const[message,setMessage]=useState(\"\");const[checking,setChecking]=useState(false);const[opening,setOpening]=useState(false);const handleCheck=async()=>{if(!code.trim()||checking)return;setChecking(true);setGift(null);setMessage(\"\");try{const res=await checkGift(code.trim().toUpperCase());setGift(res.gift);setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");}catch(_unused){setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");}finally{setChecking(false);}};const handleOpenGift=async()=>{if(!gift||opening)return;setOpening(true);try{await downloadFile(gift.file_url);await markGiftUsed(gift.code);// ‚úÖ –¢–û–õ–¨–ö–û –ó–î–ï–°–¨\n}catch(e){console.error(\"OPEN ERROR:\",e);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"check-page\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"gift \".concat(gift?\"active\":\"\"),onClick:handleOpenGift,animate:gift?opening?{scale:[1,1.3,0.6],opacity:[1,1,0]}:{scale:[1,1.08,1]}:{},transition:opening?{duration:1.2}:gift?{duration:1.4,repeat:Infinity}:{},children:\"\\uD83C\\uDF81\"}),!gift&&/*#__PURE__*/_jsxs(\"div\",{className:\"code-box\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0435\\u043A\\u0440\\u0435\\u0442\\u043D\\u044B\\u0439 \\u043A\\u043E\\u0434\",value:code,onChange:e=>setCode(e.target.value.toUpperCase())}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCheck,disabled:checking,children:checking?\"–ü—Ä–æ–≤–µ—Ä–∫–∞...\":\"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"hint\",children:message})]});}export default CheckGiftPage;","map":{"version":3,"names":["useState","motion","checkGift","markGiftUsed","jsx","_jsx","jsxs","_jsxs","downloadFile","url","res","fetch","blob","blobUrl","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","CheckGiftPage","code","setCode","gift","setGift","message","setMessage","checking","setChecking","opening","setOpening","handleCheck","trim","toUpperCase","_unused","handleOpenGift","file_url","e","console","error","className","children","div","concat","onClick","animate","scale","opacity","transition","duration","repeat","Infinity","placeholder","value","onChange","target","disabled"],"sources":["C:/Users/–ö—Å–µ–Ω–∏—è/Desktop/gift-frontend/frontend/src/pages/CheckGiftPage.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { checkGift, markGiftUsed } from \"../api\";\r\nimport \"./CheckGiftPage.css\";\r\n\r\nasync function downloadFile(url) {\r\n  const res = await fetch(url);\r\n  const blob = await res.blob();\r\n\r\n  const blobUrl = window.URL.createObjectURL(blob);\r\n  const a = document.createElement(\"a\");\r\n  a.href = blobUrl;\r\n  a.download = \"gift\";\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  document.body.removeChild(a);\r\n  window.URL.revokeObjectURL(blobUrl);\r\n}\r\n\r\nfunction CheckGiftPage() {\r\n  const [code, setCode] = useState(\"\");\r\n  const [gift, setGift] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [checking, setChecking] = useState(false);\r\n  const [opening, setOpening] = useState(false);\r\n\r\n  const handleCheck = async () => {\r\n    if (!code.trim() || checking) return;\r\n\r\n    setChecking(true);\r\n    setGift(null);\r\n    setMessage(\"\");\r\n\r\n    try {\r\n      const res = await checkGift(code.trim().toUpperCase());\r\n\r\n      setGift(res.gift);\r\n      setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");\r\n    } catch {\r\n      setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");\r\n    } finally {\r\n      setChecking(false);\r\n    }\r\n  };\r\n\r\n  const handleOpenGift = async () => {\r\n    if (!gift || opening) return;\r\n\r\n    setOpening(true);\r\n\r\n    try {\r\n      await downloadFile(gift.file_url);\r\n      await markGiftUsed(gift.code); // ‚úÖ –¢–û–õ–¨–ö–û –ó–î–ï–°–¨\r\n    } catch (e) {\r\n      console.error(\"OPEN ERROR:\", e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"check-page\">\r\n      <motion.div\r\n        className={`gift ${gift ? \"active\" : \"\"}`}\r\n        onClick={handleOpenGift}\r\n        animate={\r\n          gift\r\n            ? opening\r\n              ? { scale: [1, 1.3, 0.6], opacity: [1, 1, 0] }\r\n              : { scale: [1, 1.08, 1] }\r\n            : {}\r\n        }\r\n        transition={\r\n          opening\r\n            ? { duration: 1.2 }\r\n            : gift\r\n            ? { duration: 1.4, repeat: Infinity }\r\n            : {}\r\n        }\r\n      >\r\n        üéÅ\r\n      </motion.div>\r\n\r\n      {!gift && (\r\n        <div className=\"code-box\">\r\n          <input\r\n            placeholder=\"–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥\"\r\n            value={code}\r\n            onChange={(e) => setCode(e.target.value.toUpperCase())}\r\n          />\r\n          <button onClick={handleCheck} disabled={checking}>\r\n            {checking ? \"–ü—Ä–æ–≤–µ—Ä–∫–∞...\" : \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {message && <div className=\"hint\">{message}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CheckGiftPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}