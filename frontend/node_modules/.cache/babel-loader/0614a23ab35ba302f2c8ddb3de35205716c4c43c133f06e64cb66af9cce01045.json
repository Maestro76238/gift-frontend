{"ast":null,"code":"import{useState}from\"react\";import{motion}from\"framer-motion\";import{getGift}from\"../api\";import\"./CheckGiftPage.css\";// üîΩ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const downloadGift=async url=>{const res=await fetch(url);const blob=await res.blob();const blobUrl=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=blobUrl;a.download=\"gift\";document.body.appendChild(a);a.click();document.body.removeChild(a);window.URL.revokeObjectURL(blobUrl);};function CheckGiftPage(){const[code,setCode]=useState(\"\");const[usedCode,setUsedCode]=useState(\"\");// ‚Üê –í–ê–ñ–ù–û\nconst[giftUrl,setGiftUrl]=useState(null);const[message,setMessage]=useState(\"\");const[opening,setOpening]=useState(false);const[checking,setChecking]=useState(false);const handleCheck=async()=>{if(checking||!code.trim())return;setChecking(true);setMessage(\"\");setGiftUrl(null);setOpening(false);try{const res=await getGift(code.trim().toUpperCase());if(res!==null&&res!==void 0&&res.gift_url){setGiftUrl(res.gift_url);setUsedCode(code.trim().toUpperCase());setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");}else{setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");}}catch(_unused){setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");}finally{setChecking(false);}};const handleGiftClick=async()=>{if(!giftUrl||opening)return;setOpening(true);setTimeout(async()=>{try{await downloadGift(giftUrl);await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/use-gift/\").concat(usedCode),{method:\"POST\"});console.log(\"POST use-gift –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω\",usedCode);}catch(e){console.error(\"–û—à–∏–±–∫–∞ use-gift:\",e);}},1200);};return/*#__PURE__*/_jsxs(\"div\",{className:\"check-page\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"gift \".concat(giftUrl?\"active\":\"\"),onClick:handleGiftClick,animate:giftUrl?opening?{scale:[1,1.3,0.6],rotate:[0,10,-10,0],opacity:[1,1,0]}:{scale:[1,1.08,1]}:{},transition:opening?{duration:1.2,ease:\"easeInOut\"}:giftUrl?{duration:1.4,repeat:Infinity}:{},children:\"\\uD83C\\uDF81\"}),!giftUrl&&/*#__PURE__*/_jsxs(\"div\",{className:\"code-box\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0435\\u043A\\u0440\\u0435\\u0442\\u043D\\u044B\\u0439 \\u043A\\u043E\\u0434\",value:code,onChange:e=>setCode(e.target.value.toUpperCase())}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCheck,disabled:checking,children:checking?\"–ü—Ä–æ–≤–µ—Ä–∫–∞...\":\"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"hint\",children:message})]});}export default CheckGiftPage;","map":{"version":3,"names":["useState","motion","getGift","jsx","_jsx","jsxs","_jsxs","downloadGift","url","res","fetch","blob","blobUrl","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","CheckGiftPage","code","setCode","usedCode","setUsedCode","giftUrl","setGiftUrl","message","setMessage","opening","setOpening","checking","setChecking","handleCheck","trim","toUpperCase","gift_url","_unused","handleGiftClick","setTimeout","concat","process","env","REACT_APP_API_URL","method","console","log","e","error","className","children","div","onClick","animate","scale","rotate","opacity","transition","duration","ease","repeat","Infinity","placeholder","value","onChange","target","disabled"],"sources":["C:/Users/–ö—Å–µ–Ω–∏—è/Desktop/gift-frontend/frontend/src/pages/CheckGiftPage.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { getGift } from \"../api\";\r\nimport \"./CheckGiftPage.css\";\r\n\r\n// üîΩ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞\r\nconst downloadGift = async (url) => {\r\n  const res = await fetch(url);\r\n  const blob = await res.blob();\r\n\r\n  const blobUrl = window.URL.createObjectURL(blob);\r\n  const a = document.createElement(\"a\");\r\n  a.href = blobUrl;\r\n  a.download = \"gift\";\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  document.body.removeChild(a);\r\n  window.URL.revokeObjectURL(blobUrl);\r\n};\r\n\r\nfunction CheckGiftPage() {\r\n   const [code, setCode] = useState(\"\");    \r\n   const [usedCode, setUsedCode] = useState(\"\"); // ‚Üê –í–ê–ñ–ù–û\r\n   const [giftUrl, setGiftUrl] = useState(null);\r\n   const [message, setMessage] = useState(\"\");\r\n   const [opening, setOpening] = useState(false);\r\n   const [checking, setChecking] = useState(false);\r\n\r\n  const handleCheck = async () => {\r\n    if (checking || !code.trim()) return;\r\n\r\n    setChecking(true);\r\n    setMessage(\"\");\r\n    setGiftUrl(null);\r\n    setOpening(false);\r\n\r\n    try {\r\n      const res = await getGift(code.trim().toUpperCase());\r\n\r\n      if (res?.gift_url) {\r\n        setGiftUrl(res.gift_url);\r\n        setUsedCode(code.trim().toUpperCase());\r\n        setMessage(\"üéâ –ö–æ–¥ –≤–µ—Ä–Ω—ã–π! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ üéÅ\");\r\n      } else {\r\n        setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");\r\n      }\r\n    } catch {\r\n      setMessage(\"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥\");\r\n    } finally {\r\n      setChecking(false);\r\n    }\r\n  };\r\n\r\nconst handleGiftClick = async () => {\r\n  if (!giftUrl || opening) return;\r\n\r\n  setOpening(true);\r\n\r\n  setTimeout(async () => {\r\n    try {\r\n      await downloadGift(giftUrl);\r\n\r\n      await fetch(\r\n        `${process.env.REACT_APP_API_URL}/api/use-gift/${usedCode}`,\r\n        {\r\n          method: \"POST\",\r\n        }\r\n      );\r\n\r\n      console.log(\"POST use-gift –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω\", usedCode);\r\n    } catch (e) {\r\n      console.error(\"–û—à–∏–±–∫–∞ use-gift:\", e);\r\n    }\r\n  }, 1200);\r\n};\r\n\r\n  return (\r\n    <div className=\"check-page\">\r\n      <motion.div\r\n        className={`gift ${giftUrl ? \"active\" : \"\"}`}\r\n        onClick={handleGiftClick}\r\n        animate={\r\n          giftUrl\r\n            ? opening\r\n              ? {\r\n                  scale: [1, 1.3, 0.6],\r\n                  rotate: [0, 10, -10, 0],\r\n                  opacity: [1, 1, 0],\r\n                }\r\n              : { scale: [1, 1.08, 1] }\r\n            : {}\r\n        }\r\n        transition={\r\n          opening\r\n            ? { duration: 1.2, ease: \"easeInOut\" }\r\n            : giftUrl\r\n            ? { duration: 1.4, repeat: Infinity }\r\n            : {}\r\n        }\r\n      >\r\n        üéÅ\r\n      </motion.div>\r\n\r\n      {!giftUrl && (\r\n        <div className=\"code-box\">\r\n          <input\r\n            placeholder=\"–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥\"\r\n            value={code}\r\n            onChange={(e) => setCode(e.target.value.toUpperCase())}\r\n          />\r\n          <button onClick={handleCheck} disabled={checking}>\r\n            {checking ? \"–ü—Ä–æ–≤–µ—Ä–∫–∞...\" : \"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥\"}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {message && <div className=\"hint\">{message}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CheckGiftPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}